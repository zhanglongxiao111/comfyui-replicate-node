# ComfyUI Replicate èŠ‚ç‚¹å¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿä¸Šæ‰‹

### æ­¥éª¤1: å®‰è£…

```bash
# 1. è¿›å…¥ComfyUIçš„custom_nodesç›®å½•
cd /path/to/ComfyUI/custom_nodes

# 2. å¤åˆ¶èŠ‚ç‚¹æ–‡ä»¶å¤¹
cp -r /path/to/this/folder ./comfyui-replicate-nodes

# 3. å®‰è£…ä¾èµ–
cd comfyui-replicate-nodes
pip install -r requirements.txt

# æˆ–è€…è¿è¡Œå®‰è£…è„šæœ¬
python install.py
```

### æ­¥éª¤2: è·å–APIå¯†é’¥

1. è®¿é—® [Replicate](https://replicate.com)
2. æ³¨å†Œ/ç™»å½•è´¦æˆ·
3. è¿›å…¥ **Account Settings** â†’ **API Tokens**
4. å¤åˆ¶ä½ çš„API token

### æ­¥éª¤3: é…ç½®APIå¯†é’¥

**æ–¹æ³•1: ä½¿ç”¨èŠ‚ç‚¹é…ç½®**
1. é‡å¯ComfyUI
2. åœ¨èŠ‚ç‚¹èœå•ä¸­æ‰¾åˆ° `Replicate` åˆ†ç±»
3. æ·»åŠ  `Replicate Config` èŠ‚ç‚¹
4. ç²˜è´´ä½ çš„API token
5. å‹¾é€‰ `save_token` å’Œ `test_connection`
6. æ‰§è¡ŒèŠ‚ç‚¹

**æ–¹æ³•2: ä½¿ç”¨ç¯å¢ƒå˜é‡**
```bash
export REPLICATE_API_TOKEN="your_token_here"
```

**æ–¹æ³•3: ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶**
ç¼–è¾‘ `config.json`:
```json
{
  "replicate_api_token": "your_token_here"
}
```

### æ­¥éª¤4: æµ‹è¯•è¿æ¥

```bash
python test_connection.py
```

åº”è¯¥çœ‹åˆ°:
```
âœ… Connection successful! Found XX models
```

---

## ğŸ“– åŸºç¡€å·¥ä½œæµç¤ºä¾‹

### ç¤ºä¾‹1: æ–‡æœ¬ç”Ÿæˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Replicate Config    â”‚ (ä¸€æ¬¡æ€§è®¾ç½®)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model Selector      â”‚
â”‚ search: "llama"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dynamic Node        â”‚
â”‚ prompt_text: "..."  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prediction          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Output Processor    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¤ºä¾‹2: å›¾åƒç”Ÿæˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model Selector      â”‚
â”‚ search: "stable-    â”‚
â”‚         diffusion"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dynamic Node        â”‚ â—„â”€â”€â”€â”‚ Load Image â”‚
â”‚ prompt_text:        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  "a cat"            â”‚
â”‚ primary_image: â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prediction          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Output Processor    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preview Image       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å¸¸ç”¨æ¨¡å‹æ¨è

### å›¾åƒç”Ÿæˆ
- `stability-ai/sdxl` - Stable Diffusion XL
- `black-forest-labs/flux-schnell` - å¿«é€Ÿå›¾åƒç”Ÿæˆ
- `playground-ai/playground-v2.5` - é«˜è´¨é‡å›¾åƒ

### å›¾åƒå¤„ç†
- `nightmareai/real-esrgan` - å›¾åƒè¶…åˆ†è¾¨ç‡
- `tencentarc/gfpgan` - äººè„¸ä¿®å¤
- `pollinations/modnet` - èƒŒæ™¯ç§»é™¤

### æ–‡æœ¬ç”Ÿæˆ
- `meta/llama-2-70b-chat` - LLaMA 2å¯¹è¯æ¨¡å‹
- `anthropic/claude-2` - Claude 2

### è§†é¢‘ç”Ÿæˆ
- `stability-ai/stable-video-diffusion` - è§†é¢‘ç”Ÿæˆ

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### æŠ€å·§1: ä½¿ç”¨JSONè¦†ç›–å‚æ•°

å¦‚æœæ¨¡å‹æœ‰å¾ˆå¤šå‚æ•°,å¯ä»¥ç”¨JSONä¸€æ¬¡æ€§è®¾ç½®:

```json
{
  "num_inference_steps": 50,
  "guidance_scale": 7.5,
  "negative_prompt": "blurry, bad quality",
  "width": 1024,
  "height": 1024
}
```

### æŠ€å·§2: å‚æ•°ä¼˜å…ˆçº§

è®°ä½å‚æ•°ä¼˜å…ˆçº§(ä»é«˜åˆ°ä½):
1. `param_overrides` (DICT)
2. `param_overrides_json` (JSONå­—ç¬¦ä¸²)
3. å›¾åƒç«¯å£
4. `prompt_text`
5. Schemaé»˜è®¤å€¼

### æŠ€å·§3: æŸ¥çœ‹Schemaæ‘˜è¦

`Dynamic Node` çš„ç¬¬äºŒä¸ªè¾“å‡º `schema_summary` åŒ…å«æ‰€æœ‰å‚æ•°ä¿¡æ¯,è¿æ¥åˆ° `Show Text` èŠ‚ç‚¹å¯ä»¥æŸ¥çœ‹:

```json
{
  "prompt": {
    "type": "string",
    "required": false,
    "default": "",
    "is_prompt": true
  },
  "image": {
    "type": "string",
    "is_image": true
  }
}
```

### æŠ€å·§4: å¤„ç†å¤šä¸ªå›¾åƒ

å¦‚æœæ¨¡å‹éœ€è¦å¤šå¼ å›¾åƒ,ä½¿ç”¨å¤šä¸ªå›¾åƒç«¯å£:

```
primary_image   â†’ image (ç¬¬ä¸€ä¸ªå›¾åƒå‚æ•°)
secondary_image â†’ reference_image (ç¬¬äºŒä¸ªå›¾åƒå‚æ•°)
tertiary_image  â†’ control_image (ç¬¬ä¸‰ä¸ªå›¾åƒå‚æ•°)
```

æˆ–è€…ä½¿ç”¨JSONç²¾ç¡®æŒ‡å®š:

```json
{
  "init_image": "https://...",
  "mask_image": "https://..."
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: "Invalid API token" é”™è¯¯?
**è§£å†³**:
- æ£€æŸ¥tokenæ˜¯å¦æ­£ç¡®å¤åˆ¶(æ²¡æœ‰å¤šä½™ç©ºæ ¼)
- ç¡®è®¤tokenåœ¨Replicateè´¦æˆ·ä¸­æ˜¯æ¿€æ´»çš„
- é‡æ–°ç”Ÿæˆtoken

### Q2: æ¨¡å‹æœç´¢æ²¡æœ‰ç»“æœ?
**è§£å†³**:
- å°è¯•æ›´é€šç”¨çš„æœç´¢è¯
- ç•™ç©ºæœç´¢æ¡†æŸ¥çœ‹æ‰€æœ‰æ¨¡å‹
- å‹¾é€‰ `refresh` æ¸…é™¤ç¼“å­˜

### Q3: é¢„æµ‹è¶…æ—¶?
**è§£å†³**:
- å¢åŠ  `timeout` å€¼(é»˜è®¤300ç§’)
- æŸäº›å¤æ‚æ¨¡å‹éœ€è¦æ›´é•¿æ—¶é—´
- æ£€æŸ¥ReplicateæœåŠ¡çŠ¶æ€

### Q4: å›¾åƒæ— æ³•åŠ è½½?
**è§£å†³**:
- ç¡®ä¿å›¾åƒæ˜¯ComfyUIçš„IMAGEç±»å‹
- æ£€æŸ¥å›¾åƒURLæ˜¯å¦å¯è®¿é—®
- å°è¯•ä½¿ç”¨ `Output Processor` èŠ‚ç‚¹å¤„ç†è¾“å‡º

### Q5: "No schema found" è­¦å‘Š?
**è§£å†³**:
- è¿™æ˜¯æ­£å¸¸çš„,æŸäº›æ¨¡å‹ä¸æä¾›è¯¦ç»†schema
- å¯ä»¥æ‰‹åŠ¨ä½¿ç”¨JSONè®¾ç½®å‚æ•°
- æŸ¥çœ‹æ¨¡å‹æ–‡æ¡£äº†è§£å‚æ•°

---

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰å‚æ•°éªŒè¯

```python
# åœ¨param_overrides_jsonä¸­ä½¿ç”¨
{
  "prompt": "a cat",
  "seed": 42,
  "num_outputs": 1,
  "scheduler": "K_EULER"
}
```

### ä½¿ç”¨Webhook

åœ¨ `Prediction` èŠ‚ç‚¹ä¸­è®¾ç½®webhook URL,é¢„æµ‹å®Œæˆæ—¶ä¼šæ”¶åˆ°é€šçŸ¥:

```
webhook_url: https://your-server.com/webhook
```

### æ‰¹é‡å¤„ç†

è¿æ¥å¤šä¸ª `Prediction` èŠ‚ç‚¹å¤„ç†ä¸åŒè¾“å…¥:

```
Dynamic Node 1 â†’ Prediction 1
Dynamic Node 2 â†’ Prediction 2
Dynamic Node 3 â†’ Prediction 3
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- æ¨¡å‹åˆ—è¡¨ç¼“å­˜: 1å°æ—¶
- Schemaç¼“å­˜: æ°¸ä¹…(ç±»çº§ç¼“å­˜)
- APIå“åº”ç¼“å­˜: 1å°æ—¶

### å‡å°‘APIè°ƒç”¨
1. ä½¿ç”¨ `refresh=False` (é»˜è®¤)
2. é‡å¤ä½¿ç”¨ç›¸åŒçš„ `model_info`
3. æ‰¹é‡å¤„ç†æ—¶å…±äº« `Dynamic Node`

### åŠ å¿«é¢„æµ‹é€Ÿåº¦
1. é€‰æ‹©"-turbo"æˆ–"fast"ç‰ˆæœ¬çš„æ¨¡å‹
2. å‡å°‘ `num_inference_steps`
3. ä½¿ç”¨è¾ƒå°çš„å›¾åƒå°ºå¯¸
4. è®¾ç½®åˆç†çš„ `poll_interval` (é»˜è®¤2ç§’)

---

## ğŸ“š æ›´å¤šèµ„æº

- [Replicateæ–‡æ¡£](https://replicate.com/docs)
- [Replicateæ¨¡å‹åº“](https://replicate.com/explore)
- [ComfyUIæ–‡æ¡£](https://docs.comfy.org/)
- [é¡¹ç›®GitHub](https://github.com/your-repo)

---

## ğŸ†˜ è·å–å¸®åŠ©

1. æŸ¥çœ‹ [CODE_REVIEW.md](CODE_REVIEW.md) - è¯¦ç»†æŠ€æœ¯è¯´æ˜
2. æŸ¥çœ‹ [TEST_REPORT.md](TEST_REPORT.md) - æµ‹è¯•éªŒè¯ç»“æœ
3. æŸ¥çœ‹ [README.md](README.md) - å®Œæ•´æ–‡æ¡£
4. æäº¤GitHub Issue
5. æŸ¥çœ‹ComfyUIç¤¾åŒºè®¨è®º

---

## âœ¨ å¼€å§‹ä½¿ç”¨!

ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½äº†! ğŸ‰

1. âœ… å®‰è£…å®Œæˆ
2. âœ… APIé…ç½®å®Œæˆ
3. âœ… äº†è§£åŸºæœ¬å·¥ä½œæµ
4. âœ… çŸ¥é“å¸¸è§é—®é¢˜è§£å†³æ–¹æ³•

**ä¸‹ä¸€æ­¥**:
- æ‰“å¼€ComfyUI
- æ·»åŠ  `Replicate Model Selector` èŠ‚ç‚¹
- æœç´¢ä½ å–œæ¬¢çš„æ¨¡å‹
- å¼€å§‹åˆ›ä½œ!

ç¥ä½ ä½¿ç”¨æ„‰å¿«! ğŸš€